<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>Linux里有用的shell命令总结 | Guo Hengkai&#39;s Blog</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Guo Hengkai's Blog">
    <meta name="author" content="Guo Hengkai">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="Guo Hengkai&#39;s Blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    
    

    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- Google Webfonts (Monserrat 400/700, Open Sans 400/600) -->
    <link href='//fonts.useso.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='//fonts.useso.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'>

    <!-- Load our fonts individually if IE8+, to avoid faux bold & italic rendering -->
    <!--[if IE]>
    <link href='http://fonts.useso.com/css?family=Montserrat:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:600' rel='stylesheet' type='text/css'>
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->










  
  
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/Engineering/" class="animsition-link">Engineering<small>(4)</small></a></li>
				    
				    <li><a href="/categories/Other/" class="animsition-link">Other<small>(1)</small></a></li>
				    
				    <li><a href="/categories/Research/" class="animsition-link">Research<small>(1)</small></a></li>
				    
				</ul>
        	</li>
			
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">Guo Hengkai's Blog</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/guohengkai" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            
                            
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->

        <!-- ============================ Hero Image =========================== -->

        <section id="hero" class="scrollme">
            <div class="container-fluid element-img" style="background: url(/img/bg_img.jpg) no-repeat center center fixed;background-size: cover">
                <div class="row">
                    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-8 col-md-offset-2 vertical-align cover boost text-center">
                        <div class="center-me animateme" data-when="exit" data-from="0" data-to="0.6" data-opacity="0" data-translatey="100">
                            <div>
                            	
                                <h2>Keep Learning.</h2>
                                <p></p>
				    			
                                <h2></h2>
                                <p>一枚好奇心很强的码农和攻城狮。</p>
				    			

                            </div>
                        </div>
                    </div>
                    <!-- // .col-md-12 -->
                </div>
                <div class="herofade beige-dk"></div>
            </div>
        </section>

        <!-- Height spacing helper -->
        <div class="heightblock"></div>
        <!-- // End height spacing helper -->

        <!-- ============================ END Hero Image =========================== -->
      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2016-01-21T16:13:05.000Z" itemprop="datePublished">
          2016-01-22
      </time>
    
    
    | 
    <a href='/tags/Linux/'>Linux</a>,
    
    <a href='/tags/Shell/'>Shell</a>
    
    
</span>
                <h1>Linux里有用的shell命令总结</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<p>最近简单地翻了一本书叫<a href="http://book.douban.com/subject/5974281/" target="_blank" rel="external">《Linux Shell Scripting Cookbook》</a>，有很多有用的东西，在这里简单记录备忘一下，其中略过一些比较熟或者很少用的命令。<br><a id="more"></a></p>
<h2 id="1-_变量与环境变量">1. 变量与环境变量</h2><h4 id="查看进程的环境变量">查看进程的环境变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat /proc/<span class="variable">$PID</span>/environ | tr <span class="string">'\0'</span> <span class="string">'\n'</span></span><br></pre></td></tr></table></figure>
<p>其中PID设置为相应进程的ID，tr命令将\0替换成\n。</p>
<h4 id="获取字符串长度">获取字符串长度</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ length=<span class="variable">$&#123;#var&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="检查是否为超级用户">检查是否为超级用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="variable">$UID</span> <span class="operator">-ne</span> <span class="number">0</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> Non root user. Please run as root.</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> Root user</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h4 id="查看和修改Bash提示字符串">查看和修改Bash提示字符串</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~/.bashrc | grep PS1  <span class="comment"># 查看</span></span><br><span class="line">$ PS1=<span class="string">"PROMPT&gt;"</span>  <span class="comment"># 修改</span></span><br></pre></td></tr></table></figure>
<h4 id="使用函数添加环境变量">使用函数添加环境变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">prepend</span></span>() &#123; [ <span class="operator">-d</span> <span class="string">"<span class="variable">$2</span>"</span> ] &amp;&amp; <span class="built_in">eval</span> <span class="variable">$1</span>=\<span class="string">"<span class="variable">$2</span>\$\&#123;<span class="variable">$1</span>:+':'\$<span class="variable">$1</span>\&#125;\" &amp;&amp; export <span class="variable">$1</span>; &#125;</span></span><br></pre></td></tr></table></figure>
<p>该函数首先会检查第二个参数的目录是否存在，若存在就将其插入到第一个参数指定的变量，若变量为空则不插入冒号。它利用了shell参数扩展：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;parameter:+expression&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>若parameter不为空则使用experssion的值。</p>
<h2 id="2-_数学运算">2. 数学运算</h2><h4 id="整数运算">整数运算</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">let</span> result=no1+no2</span><br><span class="line">$ result=$[ no1 + no2 ]</span><br><span class="line">$ result=$(( no1 + no2))</span><br><span class="line">$ result=$(expr <span class="variable">$no1</span> + <span class="variable">$no2</span>)</span><br></pre></td></tr></table></figure>
<h4 id="bc命令">bc命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ result=`<span class="built_in">echo</span> <span class="string">"<span class="variable">$no</span> * 1.5"</span> | bc`  <span class="comment"># 支持浮点运算</span></span><br><span class="line">$ result=`<span class="built_in">echo</span> <span class="string">"scale=2;3/8"</span> | bc`  <span class="comment"># 设置小数精度为2位</span></span><br><span class="line">$ result=`<span class="built_in">echo</span> <span class="string">"obase=2;ibase=10;<span class="variable">$no</span>"</span> | bc`  <span class="comment"># 十进制转二进制</span></span><br><span class="line">$ result=`<span class="built_in">echo</span> <span class="string">"sqrt(100)+10^2"</span> | bc`  <span class="comment"># 平方根与平方</span></span><br></pre></td></tr></table></figure>
<h2 id="3-_文件描述符及重定向">3. 文件描述符及重定向</h2><h4 id="tee命令">tee命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ls * &amp;&gt; | tee <span class="operator">-a</span> log.txt</span><br></pre></td></tr></table></figure>
<p>将stdout和stderr既输出到log.txt，又作为stdout。-a选项用于追加内容。</p>
<h4 id="使用stdin作为命令参数">使用stdin作为命令参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cmd1 | cmd2 -</span><br></pre></td></tr></table></figure>
<h4 id="自定义文件描述符">自定义文件描述符</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">exec</span> <span class="number">3</span>&gt;&gt;input.txt</span><br><span class="line">$ <span class="built_in">echo</span> hehe &gt;&amp;<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>其中&gt;&gt;操作符用于追加模式的文件写入。</p>
<h2 id="4-_数组和关联数组">4. 数组和关联数组</h2><h4 id="数组">数组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ array_var=&#123;<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span>&#125;  <span class="comment"># 列表定义</span></span><br><span class="line">$ array_var[<span class="number">0</span>]=<span class="number">0</span>; array_var[<span class="number">1</span>]=<span class="number">1</span>;  <span class="comment"># 索引定义</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;array_var[0]&#125;</span>  <span class="comment"># 特定索引的元素</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;array_var[*]&#125;</span>  <span class="comment"># 数组所有值</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;array_var[@]&#125;</span>  <span class="comment"># 同上</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;#array_var[*]&#125;</span>  <span class="comment"># 数组长度</span></span><br></pre></td></tr></table></figure>
<h4 id="关联数组">关联数组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">declare</span> -A ass_array  <span class="comment"># 声明</span></span><br><span class="line">$ ass_array=([index1]=val1 [index2]=val2)  <span class="comment"># 列表定义</span></span><br><span class="line">$ ass_array[index1]=val1  <span class="comment"># 索引定义</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;!ass_array[*]&#125;</span>  <span class="comment"># 数组索引列表</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;!ass_array[@]&#125;</span>  <span class="comment"># 同上</span></span><br></pre></td></tr></table></figure>
<h2 id="5-_别名">5. 别名</h2><h4 id="设置rm保留副本">设置rm保留副本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">alias</span> rm=<span class="string">'cp $@ ~/backup &amp;&amp; rm $@'</span></span><br></pre></td></tr></table></figure>
<h4 id="删除或忽略别名">删除或忽略别名</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">unalias</span> cmd  <span class="comment"># 删除别名</span></span><br><span class="line">$ <span class="built_in">alias</span> cmd=  <span class="comment"># 另一种写法</span></span><br><span class="line">$ \cmd  <span class="comment"># 忽略别名</span></span><br></pre></td></tr></table></figure>
<h2 id="6-_获取终端信息">6. 获取终端信息</h2><h4 id="tput工具">tput工具</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ tput cols  <span class="comment"># 获取列数</span></span><br><span class="line">$ tput lines  <span class="comment"># 获取行数</span></span><br><span class="line">$ tput cup <span class="number">100</span> <span class="number">100</span>  <span class="comment"># 移动光标</span></span><br><span class="line">$ tputed  <span class="comment"># 删除从当前光标位置到行尾的所有内容</span></span><br></pre></td></tr></table></figure>
<h4 id="输入密码脚本">输入密码脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">"Enter password: "</span></span><br><span class="line">stty -echo  <span class="comment"># 禁止将输出发送到终端</span></span><br><span class="line"><span class="built_in">read</span> password</span><br><span class="line">stty <span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="built_in">echo</span> Password read.</span><br></pre></td></tr></table></figure>
<h2 id="7-_日期与时间">7. 日期与时间</h2><h4 id="读取与设置日期">读取与设置日期</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ date  <span class="comment"># 打印类似于：Sun Jan 24 11:44:00 IST 2016</span></span><br><span class="line">$ date +%s <span class="comment"># 打印纪元时</span></span><br><span class="line">$ date --date <span class="string">"input_date"</span> +%s  <span class="comment"># 日期格式转换</span></span><br><span class="line">$ date <span class="string">"+%d %B %Y"</span>  <span class="comment"># 打印年月日</span></span><br><span class="line">$ date <span class="operator">-s</span> <span class="string">"input_date"</span>  <span class="comment"># 设置日期</span></span><br></pre></td></tr></table></figure>
<h4 id="脚本计时">脚本计时</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ time cmd</span><br></pre></td></tr></table></figure>
<h4 id="延时命令">延时命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sleep no_of_seconds</span><br></pre></td></tr></table></figure>
<h2 id="8-_调试脚本">8. 调试脚本</h2><h4 id="脚本调试开关">脚本调试开关</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> -x  <span class="comment"># 在执行时显示参数和命令</span></span><br><span class="line">$ <span class="built_in">set</span> +x  <span class="comment"># 禁止调试</span></span><br><span class="line">$ <span class="built_in">set</span> -v  <span class="comment"># 在命令进行读取时显示输入</span></span><br><span class="line">$ <span class="built_in">set</span> +v  <span class="comment"># 禁止打印输入</span></span><br></pre></td></tr></table></figure>
<p>也可以在shebang上加入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash -xv</span></span><br></pre></td></tr></table></figure></p>
<h4 id="自定义调试">自定义调试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">DEBUG</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">  [ <span class="string">"<span class="variable">$_DEBUG</span>"</span> == <span class="string">"on"</span> ] &amp;&amp; <span class="variable">$@</span> || :</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中“:”表示不执行任何操作。使用时只需要在每一个在调试时想执行的语句前加DEBUG，并在执行脚本前定义_DEBUG变量为on即可。</p>
<h2 id="9-_函数与参数">9. 函数与参数</h2><h4 id="函数参数">函数参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">fname</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$1</span>, <span class="variable">$2</span>;  <span class="comment"># 参数1和参数2</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$@</span>"</span>  <span class="comment"># 以列表方式打印所有参数</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"$*"</span>  <span class="comment"># 参数被作为一个字符串</span></span><br><span class="line">  <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Fork炸弹">Fork炸弹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:() &#123; :|:&amp; &#125;;:</span><br></pre></td></tr></table></figure>
<p>该递归函数能够调用本身不断生成新的进程。</p>
<h4 id="检测命令是否成功结束">检测命令是否成功结束</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$CMD</span></span><br><span class="line"><span class="keyword">if</span> [ $? <span class="operator">-eq</span> <span class="number">0</span> ];</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$CMD</span> executed successfully"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"<span class="variable">$CMD</span> terminated unsuccessfully"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="10-_子shell">10. 子shell</h2><h4 id="将命令输出读入变量">将命令输出读入变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cmd_output = <span class="string">"<span class="variable">$(CMDS)</span>"</span>  <span class="comment"># 加引号可以保留空格和换行符</span></span><br><span class="line">$ cmd_output = `CMDS`</span><br></pre></td></tr></table></figure>
<h4 id="新建进程执行命令">新建进程执行命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">pwd</span>;</span><br><span class="line">$ (<span class="built_in">cd</span> /bin; ls);</span><br><span class="line">$ <span class="built_in">pwd</span>;</span><br></pre></td></tr></table></figure>
<h2 id="11-_获取输入">11. 获取输入</h2><h4 id="read命令">read命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">read</span> -n <span class="number">2</span> var  <span class="comment"># 从输入读取2个字符存入变量var</span></span><br><span class="line">$ <span class="built_in">read</span> <span class="operator">-s</span> var  <span class="comment"># 无回显读取</span></span><br><span class="line">$ <span class="built_in">read</span> -p <span class="string">"Enter input:"</span> var  <span class="comment"># 显示提示信息</span></span><br><span class="line">$ <span class="built_in">read</span> -t <span class="number">2</span> var  <span class="comment"># 2秒内读取输入</span></span><br><span class="line">$ <span class="built_in">read</span> <span class="operator">-d</span> <span class="string">":"</span> var  <span class="comment"># 以冒号作为输入结束</span></span><br></pre></td></tr></table></figure>
<h2 id="12-_字符分隔符和迭代器">12. 字符分隔符和迭代器</h2><h4 id="读取csv数据">读取csv数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">oldIFS=<span class="variable">$IFS</span></span><br><span class="line">IFS=,</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="variable">$data</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> Item: <span class="variable">$item</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">IFS=<span class="variable">$oldIFS</span></span><br></pre></td></tr></table></figure>
<h4 id="for循环">for循环</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;a..z&#125;; <span class="keyword">do</span> cmds; <span class="keyword">done</span>;</span><br></pre></td></tr></table></figure>
<p>也可以采用C语言的格式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>((i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++))</span><br><span class="line">&#123;</span><br><span class="line">  cmds;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="其他循环">其他循环</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition  <span class="comment"># 直到条件不成立时退出</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  cmds;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">until condition;  <span class="comment"># 直到条件成立时退出</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  cmds;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="13-_比较与测试">13. 比较与测试</h2><h4 id="算术比较">算术比较</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ [ <span class="variable">$var</span> <span class="operator">-gt</span> <span class="number">0</span> <span class="operator">-a</span> <span class="variable">$var</span> -le <span class="number">2</span> ]  <span class="comment"># 大于0且小于等于2</span></span><br><span class="line">$ [ <span class="variable">$var</span> <span class="operator">-lt</span> <span class="number">0</span> -o <span class="variable">$var</span> -ge <span class="number">2</span> ]  <span class="comment"># 小于0或大于等于2</span></span><br></pre></td></tr></table></figure>
<h4 id="文件系统测试">文件系统测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ [ <span class="operator">-d</span> <span class="variable">$var</span> ]  <span class="comment"># 是否目录</span></span><br><span class="line">$ [ <span class="operator">-e</span> <span class="variable">$var</span> ]  <span class="comment"># 文件是否存在</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串测试">字符串测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ [[ <span class="variable">$str1</span> = <span class="variable">$str2</span> ]]  <span class="comment"># 是否相同，等号前后如果不加空格则为赋值</span></span><br><span class="line">$ [[ <span class="variable">$str1</span> != <span class="variable">$str2</span> ]]  <span class="comment"># 是否不同</span></span><br><span class="line">$ [[ -z <span class="variable">$str</span> ]]  <span class="comment"># 是否为空</span></span><br><span class="line">$ [[ -n <span class="variable">$str</span> ]]  <span class="comment"># 是否不为空</span></span><br></pre></td></tr></table></figure>
<h4 id="test命令">test命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">test</span> <span class="variable">$var</span> <span class="operator">-eq</span> <span class="number">0</span>  <span class="comment"># 等价于 [ $var -eq 0 ]</span></span><br></pre></td></tr></table></figure>
<h2 id="14-_cat命令">14. cat命令</h2><h4 id="拼接标准输入">拼接标准输入</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">'Text from stdin'</span> | cat - file.txt</span><br></pre></td></tr></table></figure>
<h4 id="其他选项">其他选项</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat <span class="operator">-s</span> file  <span class="comment"># 压缩相邻空白行</span></span><br><span class="line">$ cat -T file  <span class="comment"># 将制表符显示为^|</span></span><br><span class="line">$ cat -n file  <span class="comment"># 显示行号</span></span><br></pre></td></tr></table></figure>
<h2 id="15-_录制并回放终端会话">15. 录制并回放终端会话</h2><h4 id="录制会话">录制会话</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ script -t <span class="number">2</span>&gt; timing.log <span class="operator">-a</span> output.session</span><br><span class="line">cmds;</span><br><span class="line">...</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<p>其中timing.log存储时序信息，output.session存储命令输出信息。</p>
<h4 id="回放会话">回放会话</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ scriptreplay timing.log output.session</span><br></pre></td></tr></table></figure>
<h2 id="16-_文件查找">16. 文件查找</h2><h4 id="基础find命令">基础find命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ find . -print0  <span class="comment"># 在当前目录向下遍历查找文件，使用'\0'作为定界符</span></span><br><span class="line">$ find . \( -name <span class="string">"*.txt"</span> -o -name <span class="string">"*.pdf"</span> \) -print  <span class="comment"># 匹配对应文件名</span></span><br><span class="line">$ find . -path <span class="string">"*/ghk/*"</span> -print  <span class="comment"># 匹配路径</span></span><br><span class="line">$ find . ! -name <span class="string">"*.txt"</span> -print  <span class="comment"># 否定匹配</span></span><br><span class="line">$ find . -maxdepth <span class="number">1</span> -print  <span class="comment"># 指定最大深度</span></span><br><span class="line">$ find . -type d -print  <span class="comment"># 只列出目录（文件为f，符号链接为l）</span></span><br><span class="line">$ find . \( -name <span class="string">".git"</span> -prune \) -o \( -type f -print \)  <span class="comment"># 排除目录</span></span><br></pre></td></tr></table></figure>
<h4 id="结合动作的find命令">结合动作的find命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find . -type f -name <span class="string">"*.swp"</span> -delete  <span class="comment"># 删除特定文件</span></span><br><span class="line">$ find . -type f -user root -exec chown ghk &#123;&#125; \;  <span class="comment"># 改变文件所有权</span></span><br></pre></td></tr></table></figure>
<p>其中{}为与-exec选项搭配的特殊字符串，它将依次替换为每个匹配的文件名。（当需要对找到的文件名列表作为参数时用+代替;）</p>
<h2 id="17-_xargs命令">17. xargs命令</h2><h4 id="基础xargs用法">基础xargs用法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat args.txt | xargs  <span class="comment"># 把多行输入转换成单行输出（即将\n替换为空格）</span></span><br><span class="line">$ cat args.txt | xargs -n <span class="number">3</span>  <span class="comment"># 按空格和换行符拆成每行3个参数</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"splitXsplitXsplit"</span> | xargs <span class="operator">-d</span> X  <span class="comment"># 定义定界符为X</span></span><br><span class="line">$ cat args.txt | xargs -I &#123;&#125; cmd.sh -p &#123;&#125; <span class="operator">-l</span>  <span class="comment"># 依次将每个参数传进cmd.sh执行（-I指定参数替换字符串）</span></span><br></pre></td></tr></table></figure>
<h4 id="xargs应用">xargs应用</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find . -type f -name <span class="string">"*.txt"</span> -print0 | xargs -<span class="number">0</span> rm <span class="operator">-f</span>  <span class="comment"># 删除所有txt文件（指定\0为输入定界符）</span></span><br><span class="line">$ find . -type f -name <span class="string">"*.c"</span> -print0 | xargs -<span class="number">0</span> wc <span class="operator">-l</span>  <span class="comment"># 统计C的代码行数</span></span><br></pre></td></tr></table></figure>
<h2 id="18-_用tr进行转换">18. 用tr进行转换</h2><h4 id="替换字符">替换字符</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tr <span class="variable">$str</span> <span class="string">'A-Z'</span> <span class="string">'a-z'</span>  <span class="comment"># 大写转换为小写</span></span><br></pre></td></tr></table></figure>
<p>当第二个字符集不够长时，会不断复制最后一个字符直到长度与第一个集合相等。</p>
<h4 id="删除字符">删除字符</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ tr <span class="operator">-d</span> <span class="string">'0-9'</span>  <span class="comment"># 删除数字</span></span><br><span class="line">$ tr <span class="operator">-d</span> -c <span class="string">'0-9 \n'</span>  <span class="comment"># 删除除了数字、空格和换行符的字符</span></span><br><span class="line">$ tr <span class="operator">-s</span> <span class="string">'\n'</span>  <span class="comment"># 删除多余的换行符</span></span><br></pre></td></tr></table></figure>
<h2 id="19-_排序与去重">19. 排序与去重</h2><h4 id="sort命令">sort命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort file1 file2</span><br><span class="line">$ sort -n file  <span class="comment"># 按数字顺序排序</span></span><br><span class="line">$ sort -r file  <span class="comment"># 逆序</span></span><br><span class="line">$ sort -m sorted1 sorted2  <span class="comment"># 合并有序文件</span></span><br><span class="line">$ sort -bk <span class="number">2</span> file  <span class="comment"># 按第二列排序（-b忽略前导空白行）</span></span><br></pre></td></tr></table></figure>
<h4 id="uniq命令">uniq命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sort unsorted.txt | uniq</span><br><span class="line">$ uniq -u sorted  <span class="comment"># 只显示唯一的行</span></span><br><span class="line">$ uniq -c sorted  <span class="comment"># 统计次数</span></span><br><span class="line">$ uniq <span class="operator">-d</span> sorted  <span class="comment"># 找出重复的行</span></span><br><span class="line">$ uniq <span class="operator">-s</span> <span class="number">2</span> -w <span class="number">2</span>  <span class="comment"># 忽略前2个字符（-s 2），最多比较2个字符（-w 2）</span></span><br></pre></td></tr></table></figure>
<h2 id="20-_临时文件命名">20. 临时文件命名</h2><h4 id="mktemp命令">mktemp命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ mktemp  <span class="comment"># 生成临时文件并返回文件名</span></span><br><span class="line">$ mktemp <span class="operator">-d</span>  <span class="comment"># 临时目录</span></span><br><span class="line">$ mktemp -u  <span class="comment"># 仅返回名字，不进行创建</span></span><br><span class="line">$ mktemp test.XXX  <span class="comment"># 根据模板生成文件（至少3个X）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 21. 文件名切分</span></span><br><span class="line"><span class="comment">#### %操作符和#操作符</span></span><br><span class="line">``` bash</span><br><span class="line">$ <span class="variable">$&#123;VAR%.*&#125;</span>  <span class="comment"># 从右到左非贪婪匹配通配符.*并删除匹配结果（贪婪为%%）</span></span><br><span class="line">$ <span class="variable">$&#123;VAR##*.&#125;</span>  <span class="comment"># 从左到右贪婪匹配通配符*.并删除匹配结果（非贪婪为#）</span></span><br></pre></td></tr></table></figure>
<h2 id="22-_批量重命名和移动">22. 批量重命名和移动</h2><h4 id="重命名当前目录下的图像">重命名当前目录下的图像</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">count=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> `find . -iname <span class="string">'*png'</span> -o -iname <span class="string">'*.jpg'</span> -type f -maxdepth <span class="number">1</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  new=img-<span class="variable">$count</span>.<span class="variable">$&#123;img##*.&#125;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Renaming <span class="variable">$img</span> to <span class="variable">$new</span>"</span></span><br><span class="line">  mv <span class="string">"<span class="variable">$img</span>"</span> <span class="string">"<span class="variable">$new</span>"</span></span><br><span class="line">  <span class="built_in">let</span> count++</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h4 id="rename命令">rename命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rename <span class="string">'s/ /_/g'</span> *  <span class="comment"># 将文件名的空格替换为_</span></span><br><span class="line">$ rename <span class="string">'y/a-z/A-Z'</span> *  <span class="comment"># 转换文件名大小写</span></span><br></pre></td></tr></table></figure>
<h2 id="23-_交互输入自动化">23. 交互输入自动化</h2><h4 id="自动ssh的脚本">自动ssh的脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect -f</span></span><br><span class="line">spawn ssh <span class="variable">$USERNAME</span>@<span class="variable">$IP</span></span><br><span class="line">expect <span class="string">":"</span></span><br><span class="line">send <span class="string">"<span class="variable">$PASSWORD</span>\n"</span></span><br><span class="line">interact</span><br></pre></td></tr></table></figure>
<h4 id="自动实现ssh无密钥登录">自动实现ssh无密钥登录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect</span></span><br><span class="line"><span class="built_in">set</span> username [lindex <span class="variable">$argv</span> <span class="number">0</span>]</span><br><span class="line"><span class="built_in">set</span> password [lindex <span class="variable">$argv</span> <span class="number">1</span>]</span><br><span class="line"><span class="built_in">set</span> host [lindex <span class="variable">$argv</span> <span class="number">2</span>]</span><br><span class="line">spawn scp ~/.ssh/id_dsa.pub <span class="variable">$username</span>@<span class="variable">$host</span>:~/.ssh/pub_key</span><br><span class="line">expect <span class="string">"*password*"</span></span><br><span class="line">send <span class="string">"<span class="variable">$password</span>\n"</span></span><br><span class="line">spawn ssh <span class="variable">$username</span>@<span class="variable">$host</span> <span class="string">"cat ~/.ssh/pub_key &gt;&gt; ~/.ssh/authorized_keys"</span></span><br><span class="line">expect <span class="string">"*password*"</span></span><br><span class="line">send <span class="string">"<span class="variable">$password</span>\n"</span></span><br><span class="line">expect eof</span><br></pre></td></tr></table></figure>
<h2 id="24-_查找文件差异及修补">24. 查找文件差异及修补</h2><h4 id="生成差异文件">生成差异文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff -u version1.txt version2.txt &gt; version.patch</span><br></pre></td></tr></table></figure>
<h4 id="修补文件">修补文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ patch -p1 version1.txt &lt; version.patch</span><br></pre></td></tr></table></figure>
<h2 id="25-_分割文件和数据">25. 分割文件和数据</h2><h4 id="split命令">split命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ split -b <span class="number">10</span>k data.file <span class="operator">-d</span> <span class="operator">-a</span> <span class="number">4</span> split_file  <span class="comment"># 将文件分割为10KB的小文件，前缀名为split_file，后缀为4位数字</span></span><br><span class="line">$ split <span class="operator">-l</span> <span class="number">10</span> data.file  <span class="comment"># 分割成多个文件，每个10行</span></span><br></pre></td></tr></table></figure>
<h2 id="26-_切分文件名">26. 切分文件名</h2><h4 id="提取扩展名和域名">提取扩展名和域名</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="comment"># 假设URL="www.google.com"</span></span><br><span class="line">$ <span class="variable">$&#123;URL%.*&#125;</span>  <span class="comment"># 非贪婪匹配最右并删除：www.google</span></span><br><span class="line">$ <span class="variable">$&#123;URL%%.*&#125;</span>  <span class="comment"># 贪婪匹配最右并删除：www</span></span><br><span class="line">$ <span class="variable">$&#123;URL#*.&#125;</span>  <span class="comment"># 非贪婪匹配最左并删除：google.com</span></span><br><span class="line">$ <span class="variable">$&#123;URL##*.&#125;</span>  <span class="comment"># 贪婪匹配最左并删除：com</span></span><br></pre></td></tr></table></figure>
<h2 id="27-_文件权限和所有权">27. 文件权限和所有权</h2><h4 id="chmod命令">chmod命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ chmod u=rwx g=rw o=r filename  <span class="comment"># 指定用户权限为读、写和执行，用户组权限为读和写，其他实体权限为读</span></span><br><span class="line">$ chmod o+x filename  <span class="comment"># 添加可执行权限</span></span><br><span class="line">$ chmod a-x filename  <span class="comment"># 给所有用户删除可执行权限</span></span><br><span class="line">$ chmod <span class="number">764</span> filename  <span class="comment"># rwx rw- rwx</span></span><br><span class="line">$ chmod a+t directory_name  <span class="comment"># 设置粘滞位，使得只有目录所有者才能删除目录中的文件</span></span><br><span class="line">$ chmod <span class="number">777</span> . -R  <span class="comment"># 递归修改所有文件的权限</span></span><br><span class="line">$ chmod +s executable_file  <span class="comment"># 给二进制文件添加setuid权限，使文件在执行阶段具有文件所有者的权限</span></span><br></pre></td></tr></table></figure>
<h4 id="chown命令">chown命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chown user.group filename  <span class="comment"># 更改文件所有权</span></span><br><span class="line">$ chown user.group . -R  <span class="comment"># 递归设置所有权</span></span><br></pre></td></tr></table></figure>
<h2 id="28-_创建不可修改的文件">28. 创建不可修改的文件</h2><h4 id="chattr命令">chattr命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ chattr +i file  <span class="comment"># 任何用户不能删除该文件</span></span><br><span class="line">$ chattr -i file  <span class="comment"># 恢复可写状态</span></span><br></pre></td></tr></table></figure>
<h2 id="29-_文本处理">29. 文本处理</h2><h4 id="grep命令搜索文本">grep命令搜索文本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ grep <span class="string">"pattern"</span> file1 file2 --color=auto  <span class="comment"># 在多个文件中查找pattern，并着重标记匹配的单词</span></span><br><span class="line">$ grep -E <span class="string">"[a-z]+"</span> filename  <span class="comment"># 使用正则表达式</span></span><br><span class="line">$ grep -v pattern file  <span class="comment"># 打印除包含pattern以外的行</span></span><br><span class="line">$ grep -c pattern file  <span class="comment"># 统计包含匹配字符串的行数</span></span><br><span class="line">$ cat file | grep pattern -n  <span class="comment"># 打印行号</span></span><br><span class="line">$ grep -o -b pattern file  <span class="comment"># -o只输出匹配的部分，-b打印字符或字节偏移</span></span><br><span class="line">$ grep <span class="operator">-l</span> pattern file1 file2  <span class="comment"># 搜索多个文件并找出匹配文本位于哪个文件（-L则是不匹配的列表）</span></span><br><span class="line">$ grep pattern . -R -n  <span class="comment"># 多级目录对文本进行递归搜索</span></span><br><span class="line">$ grep -i pattern file  <span class="comment"># 忽略大小写</span></span><br><span class="line">$ grep <span class="operator">-e</span> pattern1 <span class="operator">-e</span> pattern2 file  <span class="comment"># 匹配多个样式</span></span><br><span class="line">$ grep <span class="operator">-f</span> pattern_file file  <span class="comment"># 用文件指定pattern</span></span><br><span class="line">$ grep <span class="string">"main()"</span> . -r --include *.&#123;c,cpp&#125; --exclude <span class="string">"README"</span>  <span class="comment"># 指定和排除某些文件</span></span><br><span class="line">$ grep pattern . -r --exclude-dir path --exclude-from file_list  <span class="comment"># 排除目录和文件列表</span></span><br><span class="line">$ grep <span class="string">"test"</span> file* <span class="operator">-l</span>Z | xargs -<span class="number">0</span> rm  <span class="comment"># 删除带test文本的文件</span></span><br><span class="line">$ grep -q pattern file  <span class="comment"># 静默输出</span></span><br><span class="line">$ grep pattern file -A line_num  <span class="comment"># 打印匹配结果之后的line_num行（-B是之前，-C是前后）</span></span><br></pre></td></tr></table></figure>
<h4 id="cut命令按列切分文本">cut命令按列切分文本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cut <span class="operator">-f</span> <span class="number">2</span>,<span class="number">3</span> <span class="operator">-s</span> filename  <span class="comment"># 打印第2、3列，对于不含定界符'\t'的不打印该行'</span></span><br><span class="line">$ cut <span class="operator">-f</span> <span class="number">3</span> --complement filename  <span class="comment"># 打印除了第3列的所有列</span></span><br><span class="line">$ cut <span class="operator">-f</span> <span class="number">2</span> <span class="operator">-d</span> <span class="string">";"</span> filename  <span class="comment"># 以分号为定界符</span></span><br><span class="line">$ cut -c <span class="number">1</span>-<span class="number">5</span> filename  <span class="comment"># 打印前5个字符</span></span><br><span class="line">$ cut -c <span class="number">1</span>-<span class="number">3</span>,<span class="number">6</span>-<span class="number">9</span> --output-delimiter <span class="string">","</span>  <span class="comment"># 以逗号分隔打印多个字段</span></span><br></pre></td></tr></table></figure>
<h4 id="sed命令进行文本替换">sed命令进行文本替换</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sed <span class="string">'s/pattern/replace_string/'</span> file  <span class="comment"># 替换给定文本中的字符串并打印，每行只替换第一处（如果需要保存，使用-i）</span></span><br><span class="line">$ sed <span class="string">'s/pattern/replace_string/g'</span> file  <span class="comment"># 替换每行所有匹配字符串</span></span><br><span class="line">$ sed <span class="string">'s/pattern/replace_string/3g'</span> file  <span class="comment"># 从第3处开始替换</span></span><br><span class="line">$ sed <span class="string">'/^$/d'</span> file  <span class="comment"># 删除空白行</span></span><br><span class="line">$ sed <span class="string">'s/\w\+/[&amp;]/g'</span> file  <span class="comment"># 将每个单词加上中括号</span></span><br><span class="line">$ sed <span class="string">'s/\([a-z]\+\) \([A-Z]\+\)/\2 \1'</span> file  <span class="comment"># 将第一个单词和第二个进行互换（\1表示第一个匹配子串）</span></span><br><span class="line">$ sed <span class="operator">-e</span> <span class="string">'expression'</span> <span class="operator">-e</span> <span class="string">'expression'</span> file  <span class="comment"># 组合多个表达式（也可以用管道或者单引号内的分号来替代）</span></span><br><span class="line">$ sed <span class="string">"s/<span class="variable">$text</span>/HELLO"</span> file  <span class="comment"># 引用变量text，使用双引号</span></span><br></pre></td></tr></table></figure>
<h4 id="awk命令">awk命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">'BEGIN &#123; statements &#125; &#123; statements &#125; END &#123; statements &#125;'</span> file  <span class="comment"># 首先执行BEGIN，然后对每一行执行中间的命令，最后执行END</span></span><br><span class="line">$ awk <span class="string">'BEGIN &#123; print "start" &#125; &#123; print &#125; END &#123; print "end" &#125;'</span> file  <span class="comment"># 打印每一行</span></span><br><span class="line">$ awk <span class="string">'&#123; print "line no:"NR",field no:"NF, "$0="$0 &#125;'</span> file  <span class="comment"># 打印行号、每行字段数和第一个字段</span></span><br><span class="line">$ awk <span class="string">'END &#123; print NR &#125;'</span> file  <span class="comment"># 统计行数</span></span><br><span class="line">$ awk <span class="string">'&#123; print v1,v2 &#125;'</span> v1=<span class="variable">$var1</span> v2=<span class="variable">$var2</span> file  <span class="comment"># 传递外部变量</span></span><br><span class="line">$ awk <span class="string">'BEGIN &#123; getline; print "first row: ", $0 &#125; &#123; print $0 &#125;'</span>  <span class="comment"># 在BEGIN读取一行</span></span><br><span class="line">$ awk <span class="string">'NR==1,NR==4'</span> file  <span class="comment"># 读取行号为1到5的行</span></span><br><span class="line">$ awk <span class="string">'/linux/'</span>  <span class="comment"># 包含样式linux的行</span></span><br><span class="line">$ awk -F : <span class="string">'&#123; print NF &#125;'</span> /etc/passwd  <span class="comment"># 将定界符设为冒号</span></span><br><span class="line">$ <span class="built_in">echo</span> | awk <span class="string">'&#123; "command" | getline cmdout ; print cmdout &#125;'</span>  <span class="comment"># 将外部shell命令读入变量cmdout</span></span><br><span class="line">$ awk <span class="string">'/start_pattern/, /end_pattern/'</span> filename  <span class="comment"># 打印位于start_pattern与end_pattern之间的文本</span></span><br></pre></td></tr></table></figure>
<h4 id="统计词频">统计词频</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">egrep -o <span class="string">"\b[[:alpha]]+\b"</span> <span class="variable">$filename</span> | \</span><br><span class="line">awk <span class="string">'&#123; count[$0]++ &#125; END &#123; printf("%-14s%s\n","Word","Count");</span><br><span class="line">for(ind in count)</span><br><span class="line">&#123;</span><br><span class="line">  printf("%-14s%d\n",ind,count[ind]);</span><br><span class="line">&#125;&#125;'</span></span><br></pre></td></tr></table></figure>
<h4 id="按列合并文件">按列合并文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ paste file1 file2 file3 <span class="operator">-d</span> <span class="string">","</span>  <span class="comment"># 指定逗号为定界符</span></span><br></pre></td></tr></table></figure>
<h4 id="文本切片">文本切片</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="variable">$&#123;var/old_str/new_str&#125;</span>  <span class="comment"># 将变量中的old_str替换为new_str</span></span><br><span class="line">$ <span class="variable">$&#123;var:start_position:length&#125;</span>  <span class="comment"># 得到子串（-1表示最后一位，必须用括号括起来 ）</span></span><br></pre></td></tr></table></figure>
<h2 id="30-_Web页面下载">30. Web页面下载</h2><h4 id="wget命令">wget命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ wget URL -O save_name  <span class="comment"># 从URL下载文件，输出文件名为save_name</span></span><br><span class="line">$ wget URL -o <span class="built_in">log</span> -t <span class="number">5</span>  <span class="comment"># 将日志输出到log，重试次数最多为5（若为0则是不断重试）</span></span><br><span class="line">$ wget --limit-rate <span class="number">20</span>k -Q <span class="number">100</span>m URL  <span class="comment"># 限速20k，最大下载配额100m</span></span><br><span class="line">$ wget -c URL  <span class="comment"># 断点续传</span></span><br><span class="line">$ wget --mirror --convert-links URL  <span class="comment"># 递归下载整个网站</span></span><br><span class="line">$ wget -r -N <span class="operator">-l</span> -k DEPTH URL  <span class="comment"># 递归下载整个网站，最大深度DEPTH</span></span><br><span class="line">$ wget --user username --password pass URL  <span class="comment"># 提供认证信息（--ask-password则手动输入密码）</span></span><br></pre></td></tr></table></figure>
<h2 id="31-_cURL命令">31. cURL命令</h2><h4 id="curl命令">curl命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl URL --silent  <span class="comment"># 从URL下载文件输出到终端，避免显示进度信息</span></span><br><span class="line">$ curl URL -o file_name --progress  <span class="comment"># 从URL下载到文件，用井号输出进度</span></span><br><span class="line">$ curl -C - URL  <span class="comment"># 断点续传</span></span><br><span class="line">$ curl -u user:pass URL  <span class="comment"># 用户认证</span></span><br><span class="line">$ curl -I URL  <span class="comment"># 打印HTTP头部信息</span></span><br><span class="line">$ curl URL <span class="operator">-d</span> <span class="string">"postvar=postdata&amp;postvar2=postdata2"</span>  <span class="comment"># 发送POST请求</span></span><br></pre></td></tr></table></figure>
<h2 id="32-_归档与压缩">32. 归档与压缩</h2><h4 id="tar命令">tar命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ tar -cvf output.tar file1 file2 --totals <span class="comment"># 归档文件并打印总归档字节数</span></span><br><span class="line">$ tar -xvf archive.tar -C path  <span class="comment"># 提取文件到指定文件夹</span></span><br><span class="line">$ tar -Af file1.tar file2.tar  <span class="comment"># 合并归档文件</span></span><br><span class="line">$ tar <span class="operator">-f</span> archive.tar --delete file1 file2  <span class="comment"># 从归档文件中删除文件</span></span><br><span class="line">$ tar acvf archive.tar.gz file1 file2  <span class="comment"># 归档并压缩文件</span></span><br><span class="line">$ tar -cf archive.tar * --exclude <span class="string">"*.txt"</span>  <span class="comment"># 归档时排除文件</span></span><br><span class="line">$ tar -cf archive.tar * -X list  <span class="comment"># 基于列表排除文件</span></span><br></pre></td></tr></table></figure>
<h4 id="zip命令">zip命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ zip -r archive.zip folder1 folder2  <span class="comment"># 递归压缩文件夹</span></span><br><span class="line">$ zip <span class="operator">-e</span> archive.zip file  <span class="comment"># 添加压缩密码</span></span><br><span class="line">$ unzip file.zip  <span class="comment"># 解压缩</span></span><br><span class="line">$ zip <span class="operator">-d</span> archive.zip file  <span class="comment"># 删除压缩包中文件</span></span><br><span class="line">$ unzip <span class="operator">-l</span> archive.zip  <span class="comment"># 列出压缩包中的文件</span></span><br></pre></td></tr></table></figure>
<h2 id="33-_备份与同步">33. 备份与同步</h2><h4 id="rsync命令">rsync命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ rsync -av <span class="built_in">source</span>_path destination_path  <span class="comment"># 复制文件，使用归档并输出进度（源路径如果末尾带/则会把目录中的内容复制，否则把目录本身复制）</span></span><br><span class="line">$ rsync -avz <span class="built_in">source</span>_path destination_path --delete  <span class="comment"># 使用压缩模式进行同步，删除不存在的文件</span></span><br><span class="line">$ rsync -avc <span class="built_in">source</span>_path destination_path --exclude <span class="string">"pattern"</span> --exclude-from list  <span class="comment"># 传输时使用校验，且排除一些文件</span></span><br><span class="line">$ mkdir /tmp/<span class="built_in">test</span> &amp;&amp; rsync --delete-before <span class="operator">-a</span>Hv --progress --stats /tmp/<span class="built_in">test</span> path  <span class="comment"># 快速删除有海量文件的文件夹path</span></span><br></pre></td></tr></table></figure>
<h2 id="34-_远程访问和传输">34. 远程访问和传输</h2><h4 id="ssh命令">ssh命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh user@host <span class="string">'COMMANDS'</span>  <span class="comment"># 在远程执行命令</span></span><br><span class="line">$ ssh -X user@host  <span class="comment"># 开启图形化输出并显示在本地</span></span><br><span class="line">$ ssh-copy-id user@host  <span class="comment"># 自动将私钥加入远程服务器的authorized_keys文件中</span></span><br><span class="line">$ ssh <span class="operator">-f</span>L <span class="number">8000</span>:www.kernel.org:<span class="number">80</span> user@localhost -N  <span class="comment"># 将本地端口8000上的流量转发到www.kernel.org的端口80，并转入后台执行</span></span><br><span class="line">$ ssh -R <span class="number">8000</span>:localhost:<span class="number">80</span> user@host  <span class="comment"># 将远程主机端口8000上的流量转发到本地主机的端口80上</span></span><br></pre></td></tr></table></figure>
<h4 id="scp命令">scp命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ scp filename user@host:path -o port <span class="comment"># 将文件传输到远程主机，使用port端口</span></span><br><span class="line">$ scp -r src_path dest_path  <span class="comment"># 递归复制</span></span><br></pre></td></tr></table></figure>
<h2 id="35-_监视磁盘使用情况">35. 监视磁盘使用情况</h2><h4 id="du命令">du命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ du -h file1 file2  <span class="comment"># 查看文件占用的磁盘空间</span></span><br><span class="line">$ du <span class="operator">-a</span> directory_name  <span class="comment"># 查看目录下每个文件占用的空间</span></span><br><span class="line">$ du -c file1 file2  <span class="comment"># 查看总共占用的空间</span></span><br></pre></td></tr></table></figure>
<h4 id="df命令">df命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ df -h  <span class="comment"># 查看磁盘可用空间信息</span></span><br></pre></td></tr></table></figure>
<h2 id="36-_计算命令执行时间">36. 计算命令执行时间</h2><h4 id="time命令">time命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ time COMMAND -o output.txt <span class="comment"># 统计运行时间并写入output.txt文件</span></span><br><span class="line">$ time <span class="operator">-f</span> <span class="string">"Time: %U"</span> COMMAND  <span class="comment"># 格式化输出（real: %e为命令从开始到结束的时间，user: %U为实际执行时间，sys: %S为花费在内核的时间）</span></span><br></pre></td></tr></table></figure>
<h2 id="37-_系统相关登录信息">37. 系统相关登录信息</h2><h4 id="常用命令">常用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ who  <span class="comment"># 当前登录用户信息</span></span><br><span class="line">$ w  <span class="comment"># 更为详细的信息</span></span><br><span class="line">$ users  <span class="comment"># 当前登录主机的用户列表</span></span><br><span class="line">$ uptime  <span class="comment"># 系统已经运行时间</span></span><br><span class="line">$ last  <span class="comment"># 上一次启动及登录的信息</span></span><br></pre></td></tr></table></figure>
<h2 id="38-_监视命令输出">38. 监视命令输出</h2><h4 id="watch命令">watch命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ watch COMMAND  <span class="comment"># 以2秒间隔更新输出（-n设置秒数）</span></span><br><span class="line">$ watch <span class="operator">-d</span> COMMAND  <span class="comment"># 将差异之处用颜色突显出来</span></span><br></pre></td></tr></table></figure>
<h2 id="39-_收集进程信息">39. 收集进程信息</h2><h4 id="ps命令">ps命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ps -fe  <span class="comment"># 显示详细的所有进程信息</span></span><br><span class="line">$ ps -eo comm,pcpu | head  <span class="comment"># 显示命令和CPU占用率</span></span><br><span class="line">$ ps -C COMMAND_NAME  <span class="comment"># 显示特定命令的进程信息</span></span><br><span class="line">$ ps -eo cmd e  <span class="comment"># 输出环境变量</span></span><br></pre></td></tr></table></figure>
<h4 id="其他常用命令">其他常用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ top  <span class="comment"># 输出占用CPU最多的进程列表</span></span><br><span class="line">$ pgrep COMMAND  <span class="comment"># 列出特定命令的进程ID列表</span></span><br><span class="line">$ pgrep -u root COMMAND  <span class="comment"># 指定用户</span></span><br><span class="line">$ pgrep -c COMMAND  <span class="comment"># 返回匹配的进程数量</span></span><br><span class="line">$ <span class="built_in">which</span> COMMAND  <span class="comment"># 获取命令位置</span></span><br><span class="line">$ whereis COMMAND  <span class="comment"># 获取命令位置和源码路径</span></span><br><span class="line">$ file FILENAME  <span class="comment"># 获取文件信息</span></span><br><span class="line">$ whatis COMMAND  <span class="comment"># 获取命令信息</span></span><br></pre></td></tr></table></figure>
<h2 id="40-_发送信号">40. 发送信号</h2><h4 id="kill命令">kill命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">kill</span> <span class="operator">-l</span>  <span class="comment"># 打印信号编号和名称</span></span><br><span class="line">$ <span class="built_in">kill</span> PID  <span class="comment"># 发出TERM信号给进程</span></span><br><span class="line">$ <span class="built_in">kill</span> <span class="operator">-s</span> SIGNAL PID  <span class="comment"># 强行杀死进程</span></span><br></pre></td></tr></table></figure>
<h4 id="killall命令">killall命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ killall <span class="operator">-s</span> SIGNAL process_name  <span class="comment"># 通过名称发送信号</span></span><br><span class="line">$ killall -u USERNAME process_name -i  <span class="comment"># 通过用户名和进程名指定进程，并需要进行确认</span></span><br></pre></td></tr></table></figure>
<h2 id="41-_采集系统信息">41. 采集系统信息</h2><h4 id="常用命令-1">常用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ hostname  <span class="comment"># 打印主机名（或者uname -n）</span></span><br><span class="line">$ uname <span class="operator">-a</span>  <span class="comment"># 打印Linux内核信息</span></span><br><span class="line">$ uname -r  <span class="comment"># 打印内核发行版本</span></span><br><span class="line">$ uanme -m  <span class="comment"># 打印主机类型</span></span><br><span class="line">$ cat /proc/cpuinfo  <span class="comment"># 打印CPU相关信息</span></span><br><span class="line">$ cat /proc/meminfo  <span class="comment"># 打印内存信息</span></span><br><span class="line">$ cat /proc/patitions  <span class="comment"># 打印系统分区信息（也可以用fdisk -l）</span></span><br><span class="line">$ lshw  <span class="comment"># 获取系统详细信息</span></span><br><span class="line">$ lspci  <span class="comment"># 查看驱动</span></span><br><span class="line">$ cat /etc/issue  <span class="comment"># 查看系统版本</span></span><br><span class="line">$ nvidia-smi  <span class="comment"># 查看显卡状态</span></span><br></pre></td></tr></table></figure>
<h2 id="42-_用户信息管理">42. 用户信息管理</h2><h4 id="常用命令-2">常用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ useradd USER -p PASSWORD  <span class="comment"># 创建新用户</span></span><br><span class="line">$ deluser USER --remove-all-files  <span class="comment"># 删除用户</span></span><br><span class="line">$ chsh USER <span class="operator">-s</span> SHELL  <span class="comment"># 修改用户默认shell</span></span><br><span class="line">$ usermod -L USER  <span class="comment"># 锁定用户账户（-U用于解锁）</span></span><br><span class="line">$ passwd USER  <span class="comment"># 修改密码</span></span><br><span class="line">$ addgroup GROUP  <span class="comment"># 新建用户组</span></span><br><span class="line">$ addgroup USER GROUP  <span class="comment"># 将已有的用户添加到一个组</span></span><br><span class="line">$ delgroup GROUP  <span class="comment"># 删除用户组</span></span><br><span class="line">$ figer USER  <span class="comment"># 显示用户信息</span></span><br></pre></td></tr></table></figure>
<h2 id="43-_媒体处理">43. 媒体处理</h2><h4 id="convert命令">convert命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ convert INPUT OUTPUT  <span class="comment"># 转换图像格式</span></span><br><span class="line">$ convert image.png -resize <span class="number">1024</span>x768 image.png  <span class="comment"># 缩放图像（也可按照百分比：50%）</span></span><br></pre></td></tr></table></figure>
<h4 id="import命令">import命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ import -window root screenshot.png  <span class="comment"># 取整个屏幕</span></span><br><span class="line">$ import screenshot.png  <span class="comment"># 手动选取区域</span></span><br></pre></td></tr></table></figure>
<h4 id="ffmpeg命令">ffmpeg命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i input_file output_file  <span class="comment"># 格式转换</span></span><br><span class="line">$ ffmpeg -i input_file -vcodec copy -an output_file_video  <span class="comment"># 视频流分离</span></span><br><span class="line">$ ffmpeg -i input_file -acodec copy -vn output_file_audio  <span class="comment"># 音频流分离</span></span><br><span class="line">$ ffmpeg –i test.avi –r <span class="number">1</span> –f image2 image-%<span class="number">3</span>d.jpeg  <span class="comment"># 图片提取</span></span><br><span class="line">$ ffmpeg -i movie.mp4 <span class="number">2</span>&gt;&amp;<span class="number">1</span> | grep Duration  <span class="comment"># 获取视频时长</span></span><br><span class="line">$ ffmpeg -ss START -t LENGTH -i INPUTFILE -vcodec copy -acodec copy OUTFILE  <span class="comment"># 视频切片</span></span><br><span class="line">$ ffmpeg -i in.mkv -codec copy -map <span class="number">0</span> <span class="operator">-f</span> segment -segment_time <span class="number">10</span> out%<span class="number">03</span>d.mkv  <span class="comment"># 按10秒切片</span></span><br></pre></td></tr></table></figure>
<h2 id="44-_调试相关">44. 调试相关</h2><h4 id="常用命令-3">常用命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ulimit</span> –c unlimited  <span class="comment"># 使出现segmentation fault时保存core文件，之后可用gdb查看</span></span><br><span class="line">$ objdump -T file  <span class="comment"># 查看文件的动态符号</span></span><br><span class="line">$ ldd file  <span class="comment"># 查看应用程序对库的依赖</span></span><br></pre></td></tr></table></figure>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2016/05/13/cpp-rvalue/" style="float: left;">
        ← C++11中右值的传参及返回值优化
    </a>
    
    
    <a class="pull-right" href="/2016/01/22/caffe-mat-c/">
        调用Caffe时Matlab与C++混用的坑 →
    </a>
    
</nav>

        <div class="duoshuo"></div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By Guo Hengkai. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/guohengkai" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    
                    
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>
</html>
